<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ChartPoint | Login/Register</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:"Poppins", sans-serif;}
body{height:100vh;background:#f5f6fa;display:flex;justify-content:center;align-items:center;}
.container{background:#fff;padding:40px 30px;border-radius:15px;width:350px;box-shadow:0 8px 20px rgba(0,0,0,0.15);}
h2{text-align:center;margin-bottom:30px;font-weight:600;color:#2f3640;}
.input-group{margin-bottom:20px;}
.input-group input{width:100%;padding:12px 15px;border-radius:10px;border:1px solid #dcdde1;outline:none;transition:0.3s;}
.input-group input:focus{border-color:#00a8ff;box-shadow:0 0 5px rgba(0,168,255,0.3);}
.btn{width:100%;padding:12px;background:#00a8ff;color:white;font-weight:bold;border:none;border-radius:10px;cursor:pointer;transition:0.3s;}
.btn:hover{background:#0097e6;}
.toggle-link{text-align:center;margin-top:10px;font-size:0.9rem;color:#7f8fa6;}
.toggle-link a{color:#00a8ff;cursor:pointer;text-decoration:none;font-weight:500;}
.hidden{display:none;}
</style>
</head>
<body>

<div class="container">
  <div id="loginForm">
    <h2>Login</h2>
    <div class="input-group"><input type="text" id="loginPhone" placeholder="Phone number"></div>
    <div class="input-group"><input type="password" id="loginPassword" placeholder="Password"></div>
    <button class="btn" id="loginBtn">Login</button>
    <div class="toggle-link"><a id="forgotPasswordLink">Forgot Password?</a></div>
    <div class="toggle-link">Don't have an account? <a id="showRegister">Sign Up</a></div>
  </div>

  <div id="registerForm" class="hidden">
    <h2>Register</h2>
    <div class="input-group"><input type="text" id="registerName" placeholder="Full Name"></div>
    <div class="input-group"><input type="text" id="registerPhone" placeholder="Phone number"></div>
    <div class="input-group"><input type="password" id="registerPassword" placeholder="Password"></div>
    <button class="btn" id="registerBtn">Register</button>
    <div class="toggle-link">Already have an account? <a id="showLogin">Login</a></div>
  </div>
</div>

<script>
const backendURL = "https://chartpoint-backend.onrender.com"; // Render backend URL

const loginForm = document.getElementById("loginForm");
const registerForm = document.getElementById("registerForm");
const showRegister = document.getElementById("showRegister");
const showLogin = document.getElementById("showLogin");

// Toggle between login and register
showRegister.addEventListener("click", () => {
  loginForm.classList.add("hidden");
  registerForm.classList.remove("hidden");
});
showLogin.addEventListener("click", () => {
  registerForm.classList.add("hidden");
  loginForm.classList.remove("hidden");
});

// Login
document.getElementById("loginBtn").addEventListener("click", async () => {
  const phone = document.getElementById("loginPhone").value.trim();
  const password = document.getElementById("loginPassword").value.trim();
  if (!phone || !password) { alert("Enter all fields"); return; }

  try {
    const res = await fetch(`${backendURL}/login`, {
      method: "POST",
      headers: {"Content-Type": "application/json"},
      body: JSON.stringify({ phone, password })
    });
    const data = await res.json();
    alert(data.message);
  } catch (err) {
    alert("Server not reachable. Please try again later.");
  }
});

// Register
document.getElementById("registerBtn").addEventListener("click", async () => {
  const name = document.getElementById("registerName").value.trim();
  const phone = document.getElementById("registerPhone").value.trim();
  const password = document.getElementById("registerPassword").value.trim();
  if (!name || !phone || !password) { alert("Enter all fields"); return; }

  try {
    const res = await fetch(`${backendURL}/register`, {
      method: "POST",
      headers: {"Content-Type": "application/json"},
      body: JSON.stringify({ name, phone, password })
    });
    const data = await res.json();
    alert(data.message);
    if (data.message === "Registration successful") {
      registerForm.classList.add("hidden");
      loginForm.classList.remove("hidden");
    }
  } catch (err) {
    alert("Server not reachable. Please try again later.");
  }
});
</script>

</body>
</html>
